 -- connect to Hive
beeline -u jdbc:hive2://localhost:10000

-- use database
use zs2134_nyu_edu;

CREATE EXTERNAL TABLE weather(
WBANNO INT, 
LST_DATE STRING, 
CRX_VN STRING, 
LONGITUDE DOUBLE,LATITUDE DOUBLE, 
T_DAILY_MAX DOUBLE, T_DAILY_MIN DOUBLE,T_DAILY_MEAN DOUBLE, T_DAILY_AVG DOUBLE, 
P_DAILY_CALC DOUBLE,
SOLARAD_DAILY DOUBLE,
SUR_TEMP_DAILY_TYPE STRING,SUR_TEMP_DAILY_MAX DOUBLE,SUR_TEMP_DAILY_MIN DOUBLE,SUR_TEMP_DAILY_AVG DOUBLE,
RH_DAILY_MAX STRING,RH_DAILY_MIN INT, RH_DAILY_AVG STRING,
SOIL_MOISTURE_5_DAILY DOUBLE, SOIL_MOISTURE_10_DAILY DOUBLE,SOIL_MOISTURE_20_DAILY DOUBLE,SOIL_MOISTURE_50_DAILY DOUBLE,SOIL_MOISTURE_100_DAILY DOUBLE,
SOIL_TEMP_5_DAILY DOUBLE, SOIL_TEMP_10_DAILY DOUBLE, SOIL_TEMP_20_DAILY DOUBLE, SOIL_TEMP_50_DAILY DOUBLE, SOIL_TEMP_100_DAILY DOUBLE)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe' 
WITH SERDEPROPERTIES ("field.delim"="\s+")
LOCATION 'hdfs://nyu-dataproc-m/user/zs2134_nyu_edu/project/weather';

ALTER TABLE <weather> SET SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe';

add jar /usr/lib/hive/lib/hive-contrib-3.1.2.jar;
